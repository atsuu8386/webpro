import{r as C,a as i,o as n,b as e,t as l,d as x,e as m,f as _,g as h,h as b,j as u,F as y,i as w,n as O,v as f,k as T,w as M,c as V}from"./vue-kMPmmKrw.js";import"./bootstrap-D5_hyIF7.js";import{_ as E,L as I}from"./LoadingSpinner-CfOyOWer.js";import"./vendor-B9ygI19o.js";const F=window.axios,D={name:"OrderModal",components:{LoadingSpinner:I},props:{show:{type:Boolean,default:!1},mode:{type:String,default:"add",validator:r=>["add","edit","view"].includes(r)},order:{type:Object,default:()=>null},errors:{type:Object,default:()=>({})}},data(){return{localForm:{customer_id:"",order_number:"",order_date:new Date().toISOString().split("T")[0],desired_delivery_date:null,shipping_address_id:null,shipping_address_custom:null,total_amount:0,is_total_manual:0,shipping_fee:0,order_source:"shop",payment_status:"unpaid",payment_method:null,payment_date:null,status:"pending",notes:"",items:[]},customers:[],products:[],customerAddresses:[],selectedCustomer:null,shippingAddressType:"saved",selectedShippingAddress:null,customShippingAddress:{address_line:"",building_name:"",apartment_number:"",ward:"",district:"",city:""},isLoading:!1,t:window.orderTranslations||{}}},computed:{grandTotal(){const r=parseFloat(this.localForm.total_amount||0),s=parseFloat(this.localForm.shipping_fee||0);return r+s}},watch:{show(r){r?this.$nextTick(()=>{this.$refs.triggerButton&&this.$refs.triggerButton.click()}):this.$nextTick(()=>{const s=document.getElementById("orderModal");if(s){const a=s.querySelector('button[data-bs-dismiss="modal"]');a&&a.click()}})},order:{handler(r){if(r){if(this.localForm=JSON.parse(JSON.stringify(r)),typeof this.localForm.is_total_manual=="boolean"&&(this.localForm.is_total_manual=this.localForm.is_total_manual?1:0),this.localForm.items&&this.localForm.items.length>0&&(this.localForm.items=this.localForm.items.map(s=>({...s,quantity:parseFloat(s.quantity||0),unit_price:parseFloat(s.unit_price||0),subtotal:parseFloat(s.subtotal||0)}))),this.localForm.customer_id?(this.selectedCustomer=this.customers.find(s=>s.id==this.localForm.customer_id)||null,!this.selectedCustomer&&this.localForm.customer&&(this.selectedCustomer=this.localForm.customer),this.selectedCustomer||F.get(`/customers/${this.localForm.customer_id}`).then(s=>{this.selectedCustomer=s.data}).catch(s=>{console.error("Error fetching customer:",s),this.selectedCustomer=null})):this.selectedCustomer=null,this.localForm.shipping_address_id?(this.shippingAddressType="saved",this.loadCustomerAddresses(this.localForm.customer_id),this.$nextTick(()=>{this.selectedShippingAddress=this.customerAddresses.find(s=>s.id==this.localForm.shipping_address_id)||null})):this.localForm.shipping_address_custom?(this.shippingAddressType="custom",this.customShippingAddress=typeof this.localForm.shipping_address_custom=="string"?JSON.parse(this.localForm.shipping_address_custom):this.localForm.shipping_address_custom,this.selectedShippingAddress=null):this.localForm.customer_id&&this.loadCustomerAddresses(this.localForm.customer_id),this.localForm.order_date){let s=String(this.localForm.order_date);if(/^\d{4}-\d{2}-\d{2}$/.test(s))this.localForm.order_date=s;else{const a=s.match(/^(\d{4}-\d{2}-\d{2})/);if(a)this.localForm.order_date=a[1];else{const c=new Date(s);if(!isNaN(c.getTime())){const o=c.getFullYear(),t=String(c.getMonth()+1).padStart(2,"0"),v=String(c.getDate()).padStart(2,"0");this.localForm.order_date=`${o}-${t}-${v}`}}}}if(this.localForm.desired_delivery_date){const s=new Date(this.localForm.desired_delivery_date);if(!isNaN(s.getTime())){const a=s.getFullYear(),c=String(s.getMonth()+1).padStart(2,"0"),o=String(s.getDate()).padStart(2,"0"),t=String(s.getHours()).padStart(2,"0"),v=String(s.getMinutes()).padStart(2,"0");this.localForm.desired_delivery_date=`${a}-${c}-${o}T${t}:${v}`}}else this.localForm.order_date&&this.mode==="add"&&(this.localForm.desired_delivery_date=`${this.localForm.order_date}T09:00`);if(this.localForm.payment_date){const s=new Date(this.localForm.payment_date);this.localForm.payment_date=s.toISOString().slice(0,16)}}else this.resetForm()},immediate:!0,deep:!0},mode(){this.mode==="add"&&this.resetForm()}},mounted(){this.fetchCustomers(),this.fetchProducts(),this.$nextTick(()=>{const r=this.$refs.orderModal;r&&r.addEventListener("hidden.bs.modal",()=>{this.$emit("close")})})},methods:{__(r,s=""){return this.t[r]||s||r},onOrderDateChange(){this.localForm.order_date&&(!this.localForm.desired_delivery_date||this.mode==="add")&&(this.localForm.desired_delivery_date=`${this.localForm.order_date}T09:00`)},getFieldError(r){if(!this.errors||!this.errors[r])return null;const s=this.errors[r];return Array.isArray(s)?s[0]:s},fetchCustomers(){F.get("/customers",{params:{per_page:1e3}}).then(r=>{this.customers=r.data.data||[]}).catch(r=>{console.error(r)})},fetchProducts(){F.get("/products",{params:{per_page:1e3}}).then(r=>{this.products=r.data.data||[]}).catch(r=>{console.error(r)})},loadCustomerAddresses(r){if(!r){this.customerAddresses=[],this.selectedShippingAddress=null,this.localForm.shipping_address_id=null;return}F.get(`/customers/${r}`).then(s=>{this.selectedCustomer=s.data,this.customerAddresses=s.data.addresses||[];const a=this.customerAddresses.find(c=>c.type==="shipping"||c.is_default_shipping==1);console.log(a),a?(this.localForm.shipping_address_id=a.id,this.selectedShippingAddress=a,this.shippingAddressType="saved"):(this.localForm.shipping_address_id=null,this.selectedShippingAddress=null)}).catch(s=>{console.error(s)})},onCustomerChange(){this.localForm.customer_id?(this.selectedCustomer=this.customers.find(r=>r.id==this.localForm.customer_id)||null,this.selectedCustomer||F.get(`/customers/${this.localForm.customer_id}`).then(r=>{this.selectedCustomer=r.data}).catch(r=>{console.error("Error fetching customer:",r),this.selectedCustomer=null})):this.selectedCustomer=null,this.loadCustomerAddresses(this.localForm.customer_id)},onCustomAddressToggle(r){r.target.checked?this.shippingAddressType="custom":(this.shippingAddressType="saved",this.localForm.shipping_address_custom=null,this.customShippingAddress={address_line:"",building_name:"",apartment_number:"",ward:"",district:"",city:""})},onShippingAddressTypeChange(){this.onCustomAddressToggle({target:{checked:this.shippingAddressType==="custom"}})},onProductChange(r,s){const a=this.products.find(c=>c.id===r.product_id);a&&(r.product_name=a.name,r.product_code=a.sku,r.unit_type=a.unit_type,r.unit_label=a.unit_label,r.unit_price||(r.unit_price=a.price),this.calculateItemSubtotal(r,s))},onItemUnitChange(r){r.unit_type!=="other"&&(r.unit_label=null)},addItem(){this.localForm.items.push({product_id:null,product_name:"",product_code:null,unit_type:"piece",unit_label:null,quantity:1,unit_price:0,subtotal:0,notes:null})},removeItem(r){this.localForm.items.splice(r,1),this.calculateTotalAmount()},calculateItemSubtotal(r,s){const a=parseFloat(r.quantity||0),c=parseFloat(r.unit_price||0);r.subtotal=a*c,this.calculateTotalAmount()},calculateTotalAmount(){if(this.localForm.is_total_manual==0){const r=this.localForm.items.reduce((s,a)=>s+parseFloat(a.subtotal||0),0);this.localForm.total_amount=r}},onTotalAmountChange(){},onTotalManualChange(){this.localForm.is_total_manual==0&&this.calculateTotalAmount()},onTotalManualCheckboxChange(r){this.localForm.is_total_manual=r.target.checked?1:0,this.localForm.is_total_manual==0&&this.calculateTotalAmount()},calculateGrandTotal(){},handleSave(){const r=document.getElementById("order-form");if(r&&!r.checkValidity()){r.reportValidity();return}const s={...this.localForm,mode:this.mode};this.shippingAddressType==="saved"?s.shipping_address_custom=null:this.customShippingAddress.address_line||this.customShippingAddress.city?(s.shipping_address_id=null,s.shipping_address_custom=this.customShippingAddress):s.shipping_address_custom=null,s.desired_delivery_date?s.desired_delivery_date=new Date(s.desired_delivery_date).toISOString():s.desired_delivery_date=null,s.payment_date?s.payment_date=new Date(s.payment_date).toISOString():s.payment_date=null,s.items&&s.items.length>0?s.items=s.items.filter(a=>a.product_name&&a.product_name.trim()!=="").map(a=>{const c={...a};return!c.product_id&&c.product_name&&delete c.product_id,c}):s.items=[],(!s.items||s.items.length===0)&&(s.items=[]),this.$emit("save",s)},resetForm(){const r=new Date().toISOString().split("T")[0];this.localForm={customer_id:"",order_number:"",order_date:r,desired_delivery_date:`${r}T09:00`,shipping_address_id:null,shipping_address_custom:null,total_amount:0,is_total_manual:0,shipping_fee:0,order_source:"shop",payment_status:"unpaid",payment_method:null,payment_date:null,status:"pending",notes:"",items:[]},this.shippingAddressType="saved",this.selectedShippingAddress=null,this.customShippingAddress={address_line:"",building_name:"",apartment_number:"",ward:"",district:"",city:""},this.customerAddresses=[],this.selectedCustomer=null},getContrastColor(r){if(!r||!r.startsWith("#"))return"#000000";const s=parseInt(r.slice(1,3),16),a=parseInt(r.slice(3,5),16),c=parseInt(r.slice(5,7),16);return(.299*s+.587*a+.114*c)/255>.5?"#000000":"#ffffff"},formatPrice(r){return r?new Intl.NumberFormat("vi-VN").format(r)+" đ":"0 đ"},formatDate(r){return r?new Date(r).toLocaleDateString("vi-VN"):"--"},getStatusLabel(r){return{pending:this.__("status_pending"),confirmed:this.__("status_confirmed"),processing:this.__("status_processing"),shipped:this.__("status_shipped"),delivered:this.__("status_delivered"),cancelled:this.__("status_cancelled"),returned:this.__("status_returned")}[r]||r},getPaymentStatusLabel(r){return{unpaid:this.__("payment_unpaid"),partial:this.__("payment_partial"),paid:this.__("payment_paid"),refunded:this.__("payment_refunded")}[r]||r},populateForm(r){if(this.localForm=JSON.parse(JSON.stringify(r)),typeof this.localForm.is_total_manual=="boolean"&&(this.localForm.is_total_manual=this.localForm.is_total_manual?1:0),this.localForm.items&&this.localForm.items.length>0&&(this.localForm.items=this.localForm.items.map(s=>({...s,quantity:parseFloat(s.quantity||0),unit_price:parseFloat(s.unit_price||0),subtotal:parseFloat(s.subtotal||0)}))),this.localForm.customer_id?(this.selectedCustomer=this.customers.find(s=>s.id==this.localForm.customer_id)||null,!this.selectedCustomer&&this.localForm.customer&&(this.selectedCustomer=this.localForm.customer),this.selectedCustomer||F.get(`/customers/${this.localForm.customer_id}`).then(s=>{this.selectedCustomer=s.data}).catch(s=>{console.error("Error fetching customer:",s),this.selectedCustomer=null})):this.selectedCustomer=null,this.localForm.shipping_address_id?(this.shippingAddressType="saved",this.loadCustomerAddresses(this.localForm.customer_id),this.$nextTick(()=>{this.selectedShippingAddress=this.customerAddresses.find(s=>s.id==this.localForm.shipping_address_id)||null})):this.localForm.shipping_address_custom?(this.shippingAddressType="custom",this.customShippingAddress=typeof this.localForm.shipping_address_custom=="string"?JSON.parse(this.localForm.shipping_address_custom):this.localForm.shipping_address_custom,this.selectedShippingAddress=null):this.localForm.customer_id&&this.loadCustomerAddresses(this.localForm.customer_id),this.localForm.order_date){let s=String(this.localForm.order_date);if(!/^\d{4}-\d{2}-\d{2}$/.test(s)){const a=new Date(s);if(!isNaN(a.getTime())){const c=a.getFullYear(),o=String(a.getMonth()+1).padStart(2,"0"),t=String(a.getDate()).padStart(2,"0");this.localForm.order_date=`${c}-${o}-${t}`}}}if(this.localForm.desired_delivery_date){const s=new Date(this.localForm.desired_delivery_date);if(!isNaN(s.getTime())){const a=s.getFullYear(),c=String(s.getMonth()+1).padStart(2,"0"),o=String(s.getDate()).padStart(2,"0"),t=String(s.getHours()).padStart(2,"0"),v=String(s.getMinutes()).padStart(2,"0");this.localForm.desired_delivery_date=`${a}-${c}-${o}T${t}:${v}`}}if(this.localForm.payment_date){const s=new Date(this.localForm.payment_date);if(!isNaN(s.getTime())){const a=s.getFullYear(),c=String(s.getMonth()+1).padStart(2,"0"),o=String(s.getDate()).padStart(2,"0"),t=String(s.getHours()).padStart(2,"0"),v=String(s.getMinutes()).padStart(2,"0");this.localForm.payment_date=`${a}-${c}-${o}T${t}:${v}`}}}}},P={ref:"triggerButton",type:"button",class:"d-none","data-bs-toggle":"modal","data-bs-target":"#orderModal"},B={class:"modal modal-blur fade",tabindex:"-1",role:"dialog",ref:"orderModal",id:"orderModal","data-bs-backdrop":"static","data-bs-keyboard":"false"},U={class:"modal-dialog modal-xl",role:"document"},N={class:"modal-content"},q={class:"modal-header"},z={class:"modal-title"},L={class:"modal-body position-relative",style:{"max-height":"80vh","overflow-y":"auto"}},H={key:0,id:"order-form"},j={class:"row g-2 mb-3"},J={class:"col-md-6"},Y={class:"form-label"},G={value:""},K=["value"],W={key:0,class:"invalid-feedback"},Q={key:1,class:"mt-2"},R={class:"d-flex flex-wrap gap-1"},X={class:"col-md-3"},Z={class:"form-label"},$=["placeholder"],ee={key:0,class:"invalid-feedback"},te={class:"col-md-3"},se={class:"form-label"},le={key:0,class:"invalid-feedback"},re={class:"row g-2 mb-3"},oe={class:"col-md-6"},de={class:"form-label"},ae={key:0,class:"invalid-feedback"},ie={class:"row g-2 mb-3"},ne={class:"col-md-4"},ce={class:"form-label"},_e={value:"shop"},ue={value:"website"},he={value:"phone"},me={value:"facebook"},pe={value:"zalo"},ge={value:"telegram"},ve={value:"whatsapp"},fe={value:"other"},be={key:0,class:"invalid-feedback"},ye={class:"col-md-4"},we={class:"form-label"},ke={value:"pending"},Fe={value:"confirmed"},Se={value:"processing"},Me={value:"shipped"},Ce={value:"delivered"},xe={value:"cancelled"},Ee={value:"returned"},Ae={key:0,class:"invalid-feedback"},Te={class:"col-md-4"},Oe={class:"form-label"},Ve={value:"unpaid"},Ie={value:"partial"},De={value:"paid"},Pe={value:"refunded"},Be={key:0,class:"invalid-feedback"},Ue={class:"row g-2 mb-3"},Ne={class:"col-md-6"},qe={class:"form-label"},ze={value:""},Le={value:"cash"},He={value:"bank_transfer"},je={value:"credit_card"},Je={value:"debit_card"},Ye={value:"e_wallet"},Ge={value:"cod"},Ke={value:"other"},We={key:0,class:"invalid-feedback"},Qe={class:"col-md-6"},Re={class:"form-label"},Xe={key:0,class:"invalid-feedback"},Ze={class:"mb-3"},$e={class:"form-label"},et={key:0,class:"alert alert-info mb-2"},tt={class:"mb-2"},st={class:"form-check"},lt=["checked"],rt={class:"form-check-label"},ot={key:1,class:"border p-3 rounded mb-2"},dt={class:"row g-2"},at={class:"col-12 col-md-6"},it={class:"form-label"},nt=["placeholder"],ct={key:0,class:"invalid-feedback"},_t={class:"col-12 col-md-6"},ut={class:"form-label"},ht=["placeholder"],mt={key:0,class:"invalid-feedback"},pt={class:"col-12 col-md-6"},gt={class:"form-label"},vt=["placeholder"],ft={key:0,class:"invalid-feedback"},bt={class:"col-12 col-md-6"},yt={class:"form-label"},wt=["placeholder"],kt={key:0,class:"invalid-feedback"},Ft={class:"col-12 col-md-6"},St={class:"form-label"},Mt=["placeholder"],Ct={key:0,class:"invalid-feedback"},xt={class:"col-12 col-md-6"},Et={class:"form-label"},At=["placeholder"],Tt={key:0,class:"invalid-feedback"},Ot={class:"mb-3"},Vt={class:"d-flex justify-content-between align-items-center mb-2"},It={class:"form-label mb-0"},Dt={key:0,class:"text-danger"},Pt={class:"table-responsive"},Bt={class:"table table-sm"},Ut={style:{width:"5%"}},Nt={style:{width:"30%"}},qt={style:{width:"10%"}},zt={style:{width:"12%"}},Lt={style:{width:"15%"}},Ht={style:{width:"15%"}},jt=["onUpdate:modelValue","onChange"],Jt={value:""},Yt=["value"],Gt=["onUpdate:modelValue","placeholder"],Kt={key:1,class:"invalid-feedback"},Wt=["onUpdate:modelValue","onChange"],Qt={value:"piece"},Rt={value:"kg"},Xt={value:"gram"},Zt={value:"liter"},$t={value:"meter"},es={value:"box"},ts={value:"pack"},ss={value:"other"},ls=["onUpdate:modelValue","placeholder"],rs=["onUpdate:modelValue","onInput"],os={key:0,class:"invalid-feedback"},ds=["onUpdate:modelValue","onInput"],as={key:0,class:"invalid-feedback"},is=["onClick"],ns={class:"row g-2 mb-3"},cs={class:"col-md-6"},_s={class:"form-label"},us={key:0,class:"text-danger"},hs={class:"input-group"},ms=["readonly","required"],ps={class:"input-group-text"},gs=["checked"],vs={class:"ms-2"},fs={key:0,class:"invalid-feedback"},bs={key:1,class:"text-muted"},ys={class:"col-md-6"},ws={class:"form-label"},ks={key:0,class:"invalid-feedback"},Fs={class:"row g-2 mb-3"},Ss={class:"col-md-12"},Ms={class:"alert alert-info"},Cs={class:"mb-3"},xs={class:"form-label"},Es={key:0,class:"invalid-feedback"},As={key:1},Ts={class:"mb-3"},Os={class:"mb-3"},Vs={class:"mb-3"},Is={class:"mb-3"},Ds={class:"mb-3"},Ps={key:0,class:"mb-3"},Bs={class:"table table-sm mt-2"},Us={class:"mb-3"},Ns={class:"modal-footer"},qs={type:"button",class:"btn","data-bs-dismiss":"modal"},zs={key:1,type:"button",class:"btn btn-primary","data-bs-dismiss":"modal"};function Ls(r,s,a,c,o,t){var k;const v=C("LoadingSpinner");return n(),i("div",null,[e("button",P,null,512),e("div",B,[e("div",U,[e("div",N,[e("div",q,[e("h5",z,l(a.mode==="add"?t.__("add_order"):a.mode==="edit"?t.__("edit_order"):t.__("order_details")),1),s[26]||(s[26]=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),e("div",L,[x(v,{visible:o.isLoading},null,8,["visible"]),a.mode!=="view"?(n(),i("form",H,[e("div",j,[e("div",J,[e("label",Y,[h(l(t.__("customer"))+" ",1),s[27]||(s[27]=e("span",{class:"text-danger"},"*",-1))]),m(e("select",{"onUpdate:modelValue":s[0]||(s[0]=d=>o.localForm.customer_id=d),onChange:s[1]||(s[1]=(...d)=>t.onCustomerChange&&t.onCustomerChange(...d)),required:"",class:u(["form-select",{"is-invalid":t.getFieldError("customer_id")}])},[e("option",G,l(t.__("select_customer")),1),(n(!0),i(y,null,w(o.customers,d=>(n(),i("option",{key:d.id,value:d.id},l(d.name)+" "+l(d.phone?`(${d.phone})`:""),9,K))),128))],34),[[b,o.localForm.customer_id]]),t.getFieldError("customer_id")?(n(),i("div",W,l(t.getFieldError("customer_id")),1)):_("",!0),o.selectedCustomer&&o.selectedCustomer.tags&&o.selectedCustomer.tags.length>0?(n(),i("div",Q,[e("div",R,[(n(!0),i(y,null,w(o.selectedCustomer.tags,d=>(n(),i("span",{key:d.id,class:"badge",style:O({backgroundColor:d.color||"#3b82f6",color:t.getContrastColor(d.color||"#3b82f6")})},l(d.name),5))),128))])])):_("",!0)]),e("div",X,[e("label",Z,l(t.__("order_number")),1),m(e("input",{"onUpdate:modelValue":s[2]||(s[2]=d=>o.localForm.order_number=d),class:u(["form-control",{"is-invalid":t.getFieldError("order_number")}]),placeholder:t.__("order_number_auto")},null,10,$),[[f,o.localForm.order_number]]),t.getFieldError("order_number")?(n(),i("div",ee,l(t.getFieldError("order_number")),1)):_("",!0)]),e("div",te,[e("label",se,[h(l(t.__("order_date"))+" ",1),s[28]||(s[28]=e("span",{class:"text-danger"},"*",-1))]),m(e("input",{"onUpdate:modelValue":s[3]||(s[3]=d=>o.localForm.order_date=d),type:"date",required:"",class:u(["form-control",{"is-invalid":t.getFieldError("order_date")}]),onChange:s[4]||(s[4]=(...d)=>t.onOrderDateChange&&t.onOrderDateChange(...d))},null,34),[[f,o.localForm.order_date]]),t.getFieldError("order_date")?(n(),i("div",le,l(t.getFieldError("order_date")),1)):_("",!0)])]),e("div",re,[e("div",oe,[e("label",de,l(t.__("desired_delivery_date")),1),m(e("input",{"onUpdate:modelValue":s[5]||(s[5]=d=>o.localForm.desired_delivery_date=d),type:"datetime-local",class:u(["form-control",{"is-invalid":t.getFieldError("desired_delivery_date")}])},null,2),[[f,o.localForm.desired_delivery_date]]),t.getFieldError("desired_delivery_date")?(n(),i("div",ae,l(t.getFieldError("desired_delivery_date")),1)):_("",!0)])]),e("div",ie,[e("div",ne,[e("label",ce,[h(l(t.__("order_source"))+" ",1),s[29]||(s[29]=e("span",{class:"text-danger"},"*",-1))]),m(e("select",{"onUpdate:modelValue":s[6]||(s[6]=d=>o.localForm.order_source=d),required:"",class:u(["form-select",{"is-invalid":t.getFieldError("order_source")}])},[e("option",_e,l(t.__("source_shop")),1),e("option",ue,l(t.__("source_website")),1),e("option",he,l(t.__("source_phone")),1),e("option",me,l(t.__("source_facebook")),1),e("option",pe,l(t.__("source_zalo")),1),e("option",ge,l(t.__("source_telegram")),1),e("option",ve,l(t.__("source_whatsapp")),1),e("option",fe,l(t.__("source_other")),1)],2),[[b,o.localForm.order_source]]),t.getFieldError("order_source")?(n(),i("div",be,l(t.getFieldError("order_source")),1)):_("",!0)]),e("div",ye,[e("label",we,[h(l(t.__("status"))+" ",1),s[30]||(s[30]=e("span",{class:"text-danger"},"*",-1))]),m(e("select",{"onUpdate:modelValue":s[7]||(s[7]=d=>o.localForm.status=d),required:"",class:u(["form-select",{"is-invalid":t.getFieldError("status")}])},[e("option",ke,l(t.__("status_pending")),1),e("option",Fe,l(t.__("status_confirmed")),1),e("option",Se,l(t.__("status_processing")),1),e("option",Me,l(t.__("status_shipped")),1),e("option",Ce,l(t.__("status_delivered")),1),e("option",xe,l(t.__("status_cancelled")),1),e("option",Ee,l(t.__("status_returned")),1)],2),[[b,o.localForm.status]]),t.getFieldError("status")?(n(),i("div",Ae,l(t.getFieldError("status")),1)):_("",!0)]),e("div",Te,[e("label",Oe,[h(l(t.__("payment_status"))+" ",1),s[31]||(s[31]=e("span",{class:"text-danger"},"*",-1))]),m(e("select",{"onUpdate:modelValue":s[8]||(s[8]=d=>o.localForm.payment_status=d),required:"",class:u(["form-select",{"is-invalid":t.getFieldError("payment_status")}])},[e("option",Ve,l(t.__("payment_unpaid")),1),e("option",Ie,l(t.__("payment_partial")),1),e("option",De,l(t.__("payment_paid")),1),e("option",Pe,l(t.__("payment_refunded")),1)],2),[[b,o.localForm.payment_status]]),t.getFieldError("payment_status")?(n(),i("div",Be,l(t.getFieldError("payment_status")),1)):_("",!0)])]),e("div",Ue,[e("div",Ne,[e("label",qe,l(t.__("payment_method")),1),m(e("select",{"onUpdate:modelValue":s[9]||(s[9]=d=>o.localForm.payment_method=d),class:u(["form-select",{"is-invalid":t.getFieldError("payment_method")}])},[e("option",ze,l(t.__("select_payment_method")),1),e("option",Le,l(t.__("method_cash")),1),e("option",He,l(t.__("method_bank_transfer")),1),e("option",je,l(t.__("method_credit_card")),1),e("option",Je,l(t.__("method_debit_card")),1),e("option",Ye,l(t.__("method_e_wallet")),1),e("option",Ge,l(t.__("method_cod")),1),e("option",Ke,l(t.__("method_other")),1)],2),[[b,o.localForm.payment_method]]),t.getFieldError("payment_method")?(n(),i("div",We,l(t.getFieldError("payment_method")),1)):_("",!0)]),e("div",Qe,[e("label",Re,l(t.__("payment_date")),1),m(e("input",{"onUpdate:modelValue":s[10]||(s[10]=d=>o.localForm.payment_date=d),type:"datetime-local",class:u(["form-control",{"is-invalid":t.getFieldError("payment_date")}])},null,2),[[f,o.localForm.payment_date]]),t.getFieldError("payment_date")?(n(),i("div",Xe,l(t.getFieldError("payment_date")),1)):_("",!0)])]),e("div",Ze,[e("label",$e,l(t.__("shipping_address")),1),o.selectedShippingAddress?(n(),i("div",et,[e("strong",null,l(t.__("shipping_address"))+":",1),h(" "+l(o.selectedShippingAddress.full_address||""),1)])):_("",!0),e("div",tt,[e("label",st,[e("input",{type:"checkbox",checked:o.shippingAddressType==="custom",onChange:s[11]||(s[11]=(...d)=>t.onCustomAddressToggle&&t.onCustomAddressToggle(...d)),class:"form-check-input"},null,40,lt),e("span",rt,l(t.__("custom_address")),1)])]),o.shippingAddressType==="custom"?(n(),i("div",ot,[e("div",dt,[e("div",at,[e("label",it,l(t.__("address_line")),1),m(e("input",{"onUpdate:modelValue":s[12]||(s[12]=d=>o.customShippingAddress.address_line=d),placeholder:t.__("address_line"),class:u(["form-control",{"is-invalid":t.getFieldError("shipping_address_custom.address_line")}])},null,10,nt),[[f,o.customShippingAddress.address_line]]),t.getFieldError("shipping_address_custom.address_line")?(n(),i("div",ct,l(t.getFieldError("shipping_address_custom.address_line")),1)):_("",!0)]),e("div",_t,[e("label",ut,l(t.__("building_name")),1),m(e("input",{"onUpdate:modelValue":s[13]||(s[13]=d=>o.customShippingAddress.building_name=d),placeholder:t.__("building_name"),class:u(["form-control",{"is-invalid":t.getFieldError("shipping_address_custom.building_name")}])},null,10,ht),[[f,o.customShippingAddress.building_name]]),t.getFieldError("shipping_address_custom.building_name")?(n(),i("div",mt,l(t.getFieldError("shipping_address_custom.building_name")),1)):_("",!0)]),e("div",pt,[e("label",gt,l(t.__("apartment_number")),1),m(e("input",{"onUpdate:modelValue":s[14]||(s[14]=d=>o.customShippingAddress.apartment_number=d),placeholder:t.__("apartment_number"),class:u(["form-control",{"is-invalid":t.getFieldError("shipping_address_custom.apartment_number")}])},null,10,vt),[[f,o.customShippingAddress.apartment_number]]),t.getFieldError("shipping_address_custom.apartment_number")?(n(),i("div",ft,l(t.getFieldError("shipping_address_custom.apartment_number")),1)):_("",!0)]),e("div",bt,[e("label",yt,l(t.__("ward")),1),m(e("input",{"onUpdate:modelValue":s[15]||(s[15]=d=>o.customShippingAddress.ward=d),placeholder:t.__("ward"),class:u(["form-control",{"is-invalid":t.getFieldError("shipping_address_custom.ward")}])},null,10,wt),[[f,o.customShippingAddress.ward]]),t.getFieldError("shipping_address_custom.ward")?(n(),i("div",kt,l(t.getFieldError("shipping_address_custom.ward")),1)):_("",!0)]),e("div",Ft,[e("label",St,l(t.__("district")),1),m(e("input",{"onUpdate:modelValue":s[16]||(s[16]=d=>o.customShippingAddress.district=d),placeholder:t.__("district"),class:u(["form-control",{"is-invalid":t.getFieldError("shipping_address_custom.district")}])},null,10,Mt),[[f,o.customShippingAddress.district]]),t.getFieldError("shipping_address_custom.district")?(n(),i("div",Ct,l(t.getFieldError("shipping_address_custom.district")),1)):_("",!0)]),e("div",xt,[e("label",Et,l(t.__("city")),1),m(e("input",{"onUpdate:modelValue":s[17]||(s[17]=d=>o.customShippingAddress.city=d),placeholder:t.__("city"),class:u(["form-control",{"is-invalid":t.getFieldError("shipping_address_custom.city")}])},null,10,At),[[f,o.customShippingAddress.city]]),t.getFieldError("shipping_address_custom.city")?(n(),i("div",Tt,l(t.getFieldError("shipping_address_custom.city")),1)):_("",!0)])])])):_("",!0)]),e("div",Ot,[e("div",Vt,[e("label",It,[h(l(t.__("items"))+" ",1),o.localForm.is_total_manual==0?(n(),i("span",Dt,"*")):_("",!0)]),e("button",{type:"button",onClick:s[18]||(s[18]=(...d)=>t.addItem&&t.addItem(...d)),class:"btn btn-sm btn-success"},[s[32]||(s[32]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"icon",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},[e("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),e("path",{d:"M12 5l0 14"}),e("path",{d:"M5 12l14 0"})],-1)),h(" "+l(t.__("add_item")),1)])]),e("div",Pt,[e("table",Bt,[e("thead",null,[e("tr",null,[e("th",Ut,l(t.__("serial_number")),1),e("th",Nt,l(t.__("product_name")),1),e("th",qt,l(t.__("unit")),1),e("th",zt,l(t.__("quantity")),1),e("th",Lt,l(t.__("unit_price")),1),e("th",Ht,l(t.__("subtotal")),1),s[33]||(s[33]=e("th",{style:{width:"8%"}},null,-1))])]),e("tbody",null,[(n(!0),i(y,null,w(o.localForm.items,(d,g)=>(n(),i("tr",{key:g},[e("td",null,l(g+1),1),e("td",null,[m(e("select",{"onUpdate:modelValue":p=>d.product_id=p,onChange:p=>t.onProductChange(d,g),class:u(["form-select form-select-sm",{"is-invalid":t.getFieldError(`items.${g}.product_name`)}])},[e("option",Jt,l(t.__("select_product")),1),(n(!0),i(y,null,w(o.products,p=>(n(),i("option",{key:p.id,value:p.id},l(p.name)+" "+l(p.sku?`(${p.sku})`:""),9,Yt))),128))],42,jt),[[b,d.product_id]]),d.product_id?_("",!0):m((n(),i("input",{key:0,"onUpdate:modelValue":p=>d.product_name=p,placeholder:t.__("product_name"),class:u(["form-control form-select-sm mt-1",{"is-invalid":t.getFieldError(`items.${g}.product_name`)}])},null,10,Gt)),[[f,d.product_name]]),t.getFieldError(`items.${g}.product_name`)?(n(),i("div",Kt,l(t.getFieldError(`items.${g}.product_name`)),1)):_("",!0)]),e("td",null,[m(e("select",{"onUpdate:modelValue":p=>d.unit_type=p,onChange:p=>t.onItemUnitChange(d),class:u(["form-select form-select-sm",{"is-invalid":t.getFieldError(`items.${g}.unit_type`)}])},[e("option",Qt,l(t.__("unit_type_piece")),1),e("option",Rt,l(t.__("unit_type_kg")),1),e("option",Xt,l(t.__("unit_type_gram")),1),e("option",Zt,l(t.__("unit_type_liter")),1),e("option",$t,l(t.__("unit_type_meter")),1),e("option",es,l(t.__("unit_type_box")),1),e("option",ts,l(t.__("unit_type_pack")),1),e("option",ss,l(t.__("unit_type_other")),1)],42,Wt),[[b,d.unit_type]]),d.unit_type==="other"?m((n(),i("input",{key:0,"onUpdate:modelValue":p=>d.unit_label=p,placeholder:t.__("unit_label"),class:"form-control form-select-sm mt-1"},null,8,ls)),[[f,d.unit_label]]):_("",!0)]),e("td",null,[m(e("input",{"onUpdate:modelValue":p=>d.quantity=p,onInput:p=>t.calculateItemSubtotal(d,g),type:"number",step:"0.001",min:"0.001",class:u(["form-control form-select-sm",{"is-invalid":t.getFieldError(`items.${g}.quantity`)}])},null,42,rs),[[f,d.quantity,void 0,{number:!0}]]),t.getFieldError(`items.${g}.quantity`)?(n(),i("div",os,l(t.getFieldError(`items.${g}.quantity`)),1)):_("",!0)]),e("td",null,[m(e("input",{"onUpdate:modelValue":p=>d.unit_price=p,onInput:p=>t.calculateItemSubtotal(d,g),type:"number",step:"0.01",min:"0",class:u(["form-control form-select-sm",{"is-invalid":t.getFieldError(`items.${g}.unit_price`)}])},null,42,ds),[[f,d.unit_price,void 0,{number:!0}]]),t.getFieldError(`items.${g}.unit_price`)?(n(),i("div",as,l(t.getFieldError(`items.${g}.unit_price`)),1)):_("",!0)]),e("td",null,[e("strong",null,l(t.formatPrice(d.subtotal||0)),1)]),e("td",null,[e("button",{type:"button",onClick:p=>t.removeItem(g),class:"btn btn-sm btn-danger"},[...s[34]||(s[34]=[T('<svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" data-v-156ef61b><path stroke="none" d="M0 0h24v24H0z" fill="none" data-v-156ef61b></path><path d="M4 7l16 0" data-v-156ef61b></path><path d="M10 11l0 6" data-v-156ef61b></path><path d="M14 11l0 6" data-v-156ef61b></path><path d="M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12" data-v-156ef61b></path><path d="M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3" data-v-156ef61b></path></svg>',1)])],8,is)])]))),128))])])])]),e("div",ns,[e("div",cs,[e("label",_s,[h(l(t.__("total_amount"))+" ",1),o.localForm.is_total_manual==1&&(!o.localForm.items||o.localForm.items.length===0)?(n(),i("span",us,"*")):_("",!0)]),e("div",hs,[m(e("input",{"onUpdate:modelValue":s[19]||(s[19]=d=>o.localForm.total_amount=d),onInput:s[20]||(s[20]=(...d)=>t.onTotalAmountChange&&t.onTotalAmountChange(...d)),type:"number",step:"0.01",min:"0",class:u(["form-control",{"is-invalid":t.getFieldError("total_amount")}]),readonly:o.localForm.is_total_manual==0,required:o.localForm.is_total_manual==1&&(!o.localForm.items||o.localForm.items.length===0)},null,42,ms),[[f,o.localForm.total_amount,void 0,{number:!0}]]),e("label",ps,[e("input",{type:"checkbox",checked:o.localForm.is_total_manual==1,onChange:s[21]||(s[21]=(...d)=>t.onTotalManualCheckboxChange&&t.onTotalManualCheckboxChange(...d)),class:"form-check-input"},null,40,gs),e("span",vs,l(t.__("is_total_manual")),1)])]),t.getFieldError("total_amount")?(n(),i("div",fs,l(t.getFieldError("total_amount")),1)):_("",!0),o.localForm.is_total_manual==1&&(!o.localForm.items||o.localForm.items.length===0)?(n(),i("small",bs,l(t.__("total_amount_required_when_no_items")),1)):_("",!0)]),e("div",ys,[e("label",ws,l(t.__("shipping_fee")),1),m(e("input",{"onUpdate:modelValue":s[22]||(s[22]=d=>o.localForm.shipping_fee=d),onInput:s[23]||(s[23]=(...d)=>t.calculateGrandTotal&&t.calculateGrandTotal(...d)),type:"number",step:"0.01",min:"0",class:u(["form-control",{"is-invalid":t.getFieldError("shipping_fee")}])},null,34),[[f,o.localForm.shipping_fee,void 0,{number:!0}]]),t.getFieldError("shipping_fee")?(n(),i("div",ks,l(t.getFieldError("shipping_fee")),1)):_("",!0)])]),e("div",Fs,[e("div",Ss,[e("div",Ms,[e("strong",null,l(t.__("grand_total"))+": "+l(t.formatPrice(t.grandTotal)),1)])])]),e("div",Cs,[e("label",xs,l(t.__("notes")),1),m(e("textarea",{"onUpdate:modelValue":s[24]||(s[24]=d=>o.localForm.notes=d),class:u(["form-control",{"is-invalid":t.getFieldError("notes")}]),rows:"3"},null,2),[[f,o.localForm.notes]]),t.getFieldError("notes")?(n(),i("div",Es,l(t.getFieldError("notes")),1)):_("",!0)])])):(n(),i("div",As,[e("div",Ts,[e("strong",null,l(t.__("order_number"))+":",1),h(" "+l(o.localForm.order_number),1)]),e("div",Os,[e("strong",null,l(t.__("customer"))+":",1),h(" "+l((k=o.localForm.customer)==null?void 0:k.name),1)]),e("div",Vs,[e("strong",null,l(t.__("order_date"))+":",1),h(" "+l(t.formatDate(o.localForm.order_date)),1)]),e("div",Is,[e("strong",null,l(t.__("status"))+":",1),h(" "+l(t.getStatusLabel(o.localForm.status)),1)]),e("div",Ds,[e("strong",null,l(t.__("payment_status"))+":",1),h(" "+l(t.getPaymentStatusLabel(o.localForm.payment_status)),1)]),o.localForm.items&&o.localForm.items.length>0?(n(),i("div",Ps,[e("strong",null,l(t.__("items"))+":",1),e("table",Bs,[e("thead",null,[e("tr",null,[e("th",null,l(t.__("serial_number")),1),e("th",null,l(t.__("product_name")),1),e("th",null,l(t.__("quantity")),1),e("th",null,l(t.__("unit_price")),1),e("th",null,l(t.__("subtotal")),1)])]),e("tbody",null,[(n(!0),i(y,null,w(o.localForm.items,(d,g)=>(n(),i("tr",{key:g},[e("td",null,l(g+1),1),e("td",null,l(d.product_name),1),e("td",null,l(d.quantity)+" "+l(d.unit_display),1),e("td",null,l(t.formatPrice(d.unit_price)),1),e("td",null,l(t.formatPrice(d.subtotal)),1)]))),128))])])])):_("",!0),e("div",Us,[e("strong",null,l(t.__("grand_total"))+":",1),h(" "+l(t.formatPrice(t.grandTotal)),1)])]))]),e("div",Ns,[e("button",qs,l(t.__("cancel")),1),a.mode!=="view"?(n(),i("button",{key:0,type:"button",class:"btn btn-primary",onClick:s[25]||(s[25]=(...d)=>t.handleSave&&t.handleSave(...d))},[s[35]||(s[35]=e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"icon icon-1"},[e("path",{d:"M5 12l5 5l10 -10"})],-1)),h(" "+l(t.__("save")),1)])):(n(),i("button",zs,l(t.__("close")),1))])])])],512)])}const Hs=E(D,[["render",Ls],["__scopeId","data-v-156ef61b"]]),js={name:"AlertModal",data(){return{visible:!1,title:"",message:"",type:"info",buttonText:""}},methods:{show(r,s,a="info",c="OK"){this.title=r,this.message=s,this.type=a,this.buttonText=c,this.visible=!0},hide(){this.visible=!1}}},Js={key:0},Ys={class:"modal modal-blur fade show d-block",tabindex:"-1",role:"dialog",style:{"z-index":"1065"}},Gs={class:"modal-dialog modal-sm modal-dialog-centered",role:"document"},Ks={class:"modal-content shadow-lg"},Ws={class:"modal-body text-center py-4"},Qs={key:0,xmlns:"http://www.w3.org/2000/svg",class:"icon mb-2 text-danger icon-lg",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},Rs={key:1,xmlns:"http://www.w3.org/2000/svg",class:"icon mb-2 text-green icon-lg",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},Xs={key:2,xmlns:"http://www.w3.org/2000/svg",class:"icon mb-2 text-secondary icon-lg",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},Zs={class:"text-secondary",style:{"white-space":"pre-line"}},$s={class:"modal-footer"},el={class:"w-100"},tl={class:"row"},sl={class:"col"};function ll(r,s,a,c,o,t){return o.visible?(n(),i("div",Js,[s[5]||(s[5]=e("div",{class:"modal-backdrop fade show",style:{"z-index":"1060"}},null,-1)),e("div",Ys,[e("div",Gs,[e("div",Ks,[e("button",{type:"button",class:"btn-close",onClick:s[0]||(s[0]=(...v)=>t.hide&&t.hide(...v)),"aria-label":"Close"}),e("div",{class:u(["modal-status",`bg-${o.type}`])},null,2),e("div",Ws,[o.type==="danger"?(n(),i("svg",Qs,[...s[2]||(s[2]=[e("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"},null,-1),e("path",{d:"M12 9v2m0 4v.01"},null,-1),e("path",{d:"M5 19h14a2 2 0 0 0 1.84 -2.75l-7.1 -12.25a2 2 0 0 0 -3.5 0l-7.1 12.25a2 2 0 0 0 1.84 2.75z"},null,-1)])])):o.type==="success"?(n(),i("svg",Rs,[...s[3]||(s[3]=[e("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"},null,-1),e("path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0"},null,-1),e("path",{d:"M9 12l2 2l4 -4"},null,-1)])])):(n(),i("svg",Xs,[...s[4]||(s[4]=[e("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"},null,-1),e("path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0"},null,-1),e("path",{d:"M12 8v4"},null,-1),e("path",{d:"M12 16h.01"},null,-1)])])),e("h3",null,l(o.title),1),e("div",Zs,l(o.message),1)]),e("div",$s,[e("div",el,[e("div",tl,[e("div",sl,[e("button",{type:"button",class:"btn w-100",onClick:s[1]||(s[1]=(...v)=>t.hide&&t.hide(...v))},l(o.buttonText||"OK"),1)])])])])])])])])):_("",!0)}const rl=E(js,[["render",ll]]),S=window.axios,ol={components:{OrderModal:Hs,AlertModal:rl},data(){return{orders:{data:[],current_page:1,per_page:10,last_page:1,total:0,next_page_url:null,prev_page_url:null},search:"",perPage:10,perPageOptions:[10,20,50,100],showModal:!1,modalMode:"add",selectedOrder:null,validationErrors:{},t:window.orderTranslations||{}}},mounted(){this.fetchOrders(),this.$nextTick(()=>{const r=document.getElementById("btn-add-order"),s=document.getElementById("btn-add-order-mobile");r&&r.addEventListener("click",()=>this.openAdd()),s&&s.addEventListener("click",()=>this.openAdd())})},methods:{__(r,s=""){return this.t[r]||s||r},fetchOrders(r=1){const s={search:this.search,per_page:this.perPage,page:r};S.get("/orders",{params:s}).then(a=>{this.orders=a.data}).catch(a=>{console.error(a)})},prevPage(){this.orders.prev_page_url&&this.fetchOrders(this.orders.current_page-1)},nextPage(){this.orders.next_page_url&&this.fetchOrders(this.orders.current_page+1)},openAdd(){this.modalMode="add",this.selectedOrder=null,this.validationErrors={},this.showModal=!0},openEdit(r){this.modalMode="edit",this.selectedOrder=JSON.parse(JSON.stringify(r)),this.validationErrors={},this.showModal=!0},openView(r){this.modalMode="view",this.selectedOrder=JSON.parse(JSON.stringify(r)),this.validationErrors={},this.showModal=!0},handleModalClose(){this.showModal=!1,this.selectedOrder=null,this.validationErrors={}},handleModalSave(r){this.validationErrors={},(r.mode==="add"?S.post("/orders",r):S.put(`/orders/${r.id}`,r)).then(a=>{this.fetchOrders(),this.closeModal()}).catch(a=>{var o,t,v,k,d;console.error(a);let c="";((o=a.response)==null?void 0:o.status)===422?(a.response.data.errors&&(this.validationErrors=a.response.data.errors),c=a.response.data.message||this.__("validation_error_message")||"Dữ liệu không hợp lệ. Vui lòng kiểm tra lại."):c=((v=(t=a.response)==null?void 0:t.data)==null?void 0:v.message)||((d=(k=a.response)==null?void 0:k.data)==null?void 0:d.error)||a.message,this.$refs.alertModal.show(this.__("error")||"Lỗi",c,"danger")})},closeModal(){this.showModal=!1,this.selectedOrder=null,this.validationErrors={},this.$nextTick(()=>{const r=document.getElementById("orderModal");if(r){const s=r.querySelector('button[data-bs-dismiss="modal"]');s?s.click():this.handleModalClose()}else this.handleModalClose()})},confirmDelete(r){confirm(this.__("delete_confirm"))&&S.delete(`/orders/${r.id}`).then(()=>{this.fetchOrders()}).catch(s=>{console.error(s),alert(this.__("delete_error"))})},formatPrice(r){return r?new Intl.NumberFormat("vi-VN").format(r)+" đ":"0 đ"},formatDate(r){return r?new Date(r).toLocaleDateString("vi-VN"):"--"},getStatusClass(r){return{pending:"badge bg-warning text-warning-fg",confirmed:"badge bg-info text-info-fg",processing:"badge bg-primary text-primary-fg",shipped:"badge bg-blue text-blue-fg",delivered:"badge bg-purple text-purple-fg",cancelled:"badge bg-danger text-danger-fg",returned:"badge bg-secondary text-secondary-fg"}[r]||"badge bg-secondary text-secondary-fg"},getStatusLabel(r){return{pending:this.__("status_pending"),confirmed:this.__("status_confirmed"),processing:this.__("status_processing"),shipped:this.__("status_shipped"),delivered:this.__("status_delivered"),cancelled:this.__("status_cancelled"),returned:this.__("status_returned")}[r]||r},getStatusIcon(r){return{pending:'<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-sm me-1" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0" /><path d="M12 7v5l3 3" /></svg>',confirmed:'<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-sm me-1" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 12l2 2l4 -4" /><path d="M21 12c-1 0 -2.5 -.5 -3 -1" /><path d="M3 12c1 0 2.5 -.5 3 -1" /><path d="M12 3c0 1 0 2.5 .5 3" /><path d="M12 21c0 -1 0 -2.5 .5 -3" /><path d="M12 3v18" /></svg>',processing:'<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-sm me-1" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0" /><path d="M12 3a9 9 0 0 1 9 9" /></svg>',shipped:'<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-sm me-1" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 17m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0" /><path d="M17 17m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0" /><path d="M5 17h-2v-6l2 -5h9l4 5h1a2 2 0 0 1 2 2v4h-2m-4 0h-6m-6 -10h15" /><path d="M3 9l4 0" /></svg>',delivered:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" class="icon icon-2"><path d="M8.243 7.34l-6.38 .925l-.113 .023a1 1 0 0 0 -.44 1.684l4.622 4.499l-1.09 6.355l-.013 .11a1 1 0 0 0 1.464 .944l5.706 -3l5.693 3l.1 .046a1 1 0 0 0 1.352 -1.1l-1.091 -6.355l4.624 -4.5l.078 -.085a1 1 0 0 0 -.633 -1.62l-6.38 -.926l-2.852 -5.78a1 1 0 0 0 -1.794 0l-2.853 5.78z"></path></svg>',cancelled:'<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-sm me-1" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18 6l-12 12" /><path d="M6 6l12 12" /></svg>',returned:'<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-sm me-1" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 14l-4 -4l4 -4" /><path d="M5 10h11a4 4 0 1 1 0 8h-1" /></svg>'}[r]||""},getPaymentStatusClass(r){return{unpaid:"badge bg-danger text-danger-fg",partial:"badge bg-warning text-warning-fg",paid:"badge bg-success text-success-fg",refunded:"badge bg-secondary text-secondary-fg"}[r]||"badge bg-secondary text-secondary-fg"},getPaymentStatusLabel(r){return{unpaid:this.__("payment_unpaid"),partial:this.__("payment_partial"),paid:this.__("payment_paid"),refunded:this.__("payment_refunded")}[r]||r},getPaymentStatusIcon(r){return{unpaid:'<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-sm me-1" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M17 8v-3a1 1 0 0 0 -1 -1h-10a2 2 0 0 0 0 4h12a1 1 0 0 1 1 1v3m0 4v3a1 1 0 0 1 -1 1h-12a2 2 0 0 1 -2 -2v-12" /><path d="M20 12v4h-4a2 2 0 0 1 0 -4h4" /></svg>',partial:'<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-sm me-1" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M17 8v-3a1 1 0 0 0 -1 -1h-10a2 2 0 0 0 0 4h12a1 1 0 0 1 1 1v3m0 4v3a1 1 0 0 1 -1 1h-12a2 2 0 0 1 -2 -2v-12" /><path d="M14 12h-4" /></svg>',paid:'<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-sm me-1" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M17 8v-3a1 1 0 0 0 -1 -1h-10a2 2 0 0 0 0 4h12a1 1 0 0 1 1 1v3m0 4v3a1 1 0 0 1 -1 1h-12a2 2 0 0 1 -2 -2v-12" /><path d="M20 12v4h-4a2 2 0 0 1 0 -4h4" /></svg>',refunded:'<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-sm me-1" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 14l-4 -4l4 -4" /><path d="M5 10h11a4 4 0 1 1 0 8h-1" /><path d="M13 10l-4 4" /></svg>'}[r]||""},getPageNumbers(){const r=this.orders.current_page||1,s=this.orders.last_page||1,a=[],c=5;if(s<=c)for(let o=1;o<=s;o++)a.push(o);else if(r<=3)for(let o=1;o<=c;o++)a.push(o);else if(r>=s-2)for(let o=s-c+1;o<=s;o++)a.push(o);else for(let o=r-2;o<=r+2;o++)a.push(o);return a}}},dl={class:"card-body border-bottom py-3"},al={class:"d-flex"},il={class:"text-secondary"},nl={class:"mx-2 d-inline-block"},cl=["value"],_l={class:"ms-auto text-secondary"},ul={class:"ms-2 d-inline-block"},hl=["placeholder"],ml={class:"table-responsive"},pl={class:"table card-table table-vcenter text-nowrap datatable"},gl={class:"w-1"},vl={class:"text-secondary"},fl={class:"text-primary fw-bold"},bl={class:"text-secondary"},yl={class:"text-secondary"},wl={class:"text-primary fw-bold"},kl=["innerHTML"],Fl=["innerHTML"],Sl={class:"text-end"},Ml={class:"btn-list justify-content-end"},Cl=["href"],xl=["onClick"],El=["onClick"],Al=["onClick"],Tl={key:0},Ol={colspan:"8",class:"text-center text-secondary py-4"},Vl={class:"card-footer d-flex align-items-center"},Il={class:"m-0 text-secondary"},Dl={class:"pagination m-0 ms-auto"},Pl=["tabindex","aria-disabled"],Bl=["onClick"],Ul=["tabindex","aria-disabled"];function Nl(r,s,a,c,o,t){const v=C("OrderModal"),k=C("AlertModal");return n(),i("div",null,[e("div",dl,[e("div",al,[e("div",il,[h(l(t.__("show"))+" ",1),e("div",nl,[m(e("select",{"onUpdate:modelValue":s[0]||(s[0]=d=>o.perPage=d),onChange:s[1]||(s[1]=(...d)=>t.fetchOrders&&t.fetchOrders(...d)),class:"form-select form-select-sm"},[(n(!0),i(y,null,w(o.perPageOptions,d=>(n(),i("option",{key:d,value:d},l(d),9,cl))),128))],544),[[b,o.perPage,void 0,{number:!0}]])]),h(" "+l(t.__("entries")),1)]),e("div",_l,[h(l(t.__("search"))+": ",1),e("div",ul,[m(e("input",{"onUpdate:modelValue":s[2]||(s[2]=d=>o.search=d),onInput:s[3]||(s[3]=(...d)=>t.fetchOrders&&t.fetchOrders(...d)),type:"text",class:"form-control form-control-sm",placeholder:t.__("search_placeholder")},null,40,hl),[[f,o.search]])])])])]),e("div",ml,[e("table",pl,[e("thead",null,[e("tr",null,[e("th",gl,l(t.__("no")),1),e("th",null,l(t.__("order_number")),1),e("th",null,l(t.__("order_date")),1),e("th",null,l(t.__("customer")),1),e("th",null,l(t.__("total_amount")),1),e("th",null,l(t.__("status")),1),e("th",null,l(t.__("payment_status")),1),s[6]||(s[6]=e("th",null,null,-1))])]),e("tbody",null,[(n(!0),i(y,null,w(o.orders.data,(d,g)=>{var p;return n(),i("tr",{key:d.id},[e("td",null,[e("span",vl,l((o.orders.current_page-1)*o.orders.per_page+g+1),1)]),e("td",null,[e("span",fl,l(d.order_number),1)]),e("td",null,[e("span",bl,l(t.formatDate(d.order_date)),1)]),e("td",null,[e("span",yl,l(((p=d.customer)==null?void 0:p.name)||"--"),1)]),e("td",null,[e("span",wl,l(t.formatPrice(d.grand_total)),1)]),e("td",null,[e("span",{class:u(t.getStatusClass(d.status)),style:{display:"inline-flex","align-items":"center"}},[e("span",{innerHTML:t.getStatusIcon(d.status)},null,8,kl),h(" "+l(t.getStatusLabel(d.status)),1)],2)]),e("td",null,[e("span",{class:u(t.getPaymentStatusClass(d.payment_status)),style:{display:"inline-flex","align-items":"center"}},[e("span",{innerHTML:t.getPaymentStatusIcon(d.payment_status)},null,8,Fl),h(" "+l(t.getPaymentStatusLabel(d.payment_status)),1)],2)]),e("td",Sl,[e("div",Ml,[e("a",{href:`/orders/${d.id}/invoice`,target:"_blank",class:"btn btn-sm btn-ghost-primary"},[s[7]||(s[7]=T('<svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" data-v-746507fb><path stroke="none" d="M0 0h24v24H0z" fill="none" data-v-746507fb></path><path d="M14 3v4a1 1 0 0 0 1 1h4" data-v-746507fb></path><path d="M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z" data-v-746507fb></path><path d="M9 9l1 0" data-v-746507fb></path><path d="M9 13l6 0" data-v-746507fb></path><path d="M9 17l6 0" data-v-746507fb></path></svg>',1)),h(" "+l(t.__("print_invoice")),1)],8,Cl),e("button",{onClick:A=>t.openView(d),type:"button",class:"btn btn-sm btn-ghost-secondary"},l(t.__("view")),9,xl),e("button",{onClick:A=>t.openEdit(d),type:"button",class:"btn btn-sm btn-ghost-warning"},l(t.__("edit")),9,El),e("button",{onClick:A=>t.confirmDelete(d),type:"button",class:"btn btn-sm btn-ghost-danger"},l(t.__("delete")),9,Al)])])])}),128)),!o.orders.data||o.orders.data.length===0?(n(),i("tr",Tl,[e("td",Ol,l(t.__("no_orders_found")),1)])):_("",!0)])])]),e("div",Vl,[e("p",Il,[h(l(t.__("showing"))+" ",1),e("span",null,l(o.orders.data.length>0?(o.orders.current_page-1)*o.orders.per_page+1:0),1),h(" "+l(t.__("to"))+" ",1),e("span",null,l(o.orders.data.length>0?(o.orders.current_page-1)*o.orders.per_page+o.orders.data.length:0),1),h(" "+l(t.__("of"))+" ",1),e("span",null,l(o.orders.total||0),1),h(" "+l(t.__("entries")),1)]),e("ul",Dl,[e("li",{class:u(["page-item",{disabled:!o.orders.prev_page_url}])},[e("a",{class:"page-link",href:"#",onClick:s[4]||(s[4]=M((...d)=>t.prevPage&&t.prevPage(...d),["prevent"])),tabindex:o.orders.prev_page_url?null:"-1","aria-disabled":!o.orders.prev_page_url},[s[8]||(s[8]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"icon",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},[e("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),e("path",{d:"M15 6l-6 6l6 6"})],-1)),h(" "+l(t.__("prev")),1)],8,Pl)],2),(n(!0),i(y,null,w(t.getPageNumbers(),d=>(n(),i("li",{class:u(["page-item",{active:o.orders.current_page===d}]),key:d},[e("a",{class:"page-link",href:"#",onClick:M(g=>t.fetchOrders(d),["prevent"])},l(d),9,Bl)],2))),128)),e("li",{class:u(["page-item",{disabled:!o.orders.next_page_url}])},[e("a",{class:"page-link",href:"#",onClick:s[5]||(s[5]=M((...d)=>t.nextPage&&t.nextPage(...d),["prevent"])),tabindex:o.orders.next_page_url?null:"-1","aria-disabled":!o.orders.next_page_url},[h(l(t.__("next"))+" ",1),s[9]||(s[9]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"icon",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},[e("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),e("path",{d:"M9 6l6 6l-6 6"})],-1))],8,Ul)],2)])]),x(v,{show:o.showModal,mode:o.modalMode,order:o.selectedOrder,errors:o.validationErrors,onClose:t.handleModalClose,onSave:t.handleModalSave},null,8,["show","mode","order","errors","onClose","onSave"]),x(k,{ref:"alertModal"},null,512)])}const ql=E(ol,[["render",Nl],["__scopeId","data-v-746507fb"]]),zl=V(ql);zl.mount("#orders-app");
